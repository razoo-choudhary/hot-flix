var KhaltiCheckout=function(){"use strict";var c,h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},a=function(b,a){return b(a={exports:{}},a.exports),a.exports}(function(b,a){Object.defineProperty(a,"__esModule",{value:!0});var c="function"==typeof Symbol&&"symbol"===h(Symbol.iterator)?function(a){return void 0===a?"undefined":h(a)}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":void 0===a?"undefined":h(a)},d=a.SkipValidation=function(a){this.name="SkipValidation",this.message=a},e=a.validateSingle=function(e,a,g,h,i){var b=[];"function"==typeof a&&(a=[a]);for(var c=0;c<a.length;c++)try{var f=a[c](e,h);"string"==typeof f&&b.push(f.replace("{value}",e).replace("{key}",i))}catch(j){if(j instanceof d)break}return!0===g?b:b.length>0?b[0]:void 0};a.validate=function(d,a,f){if(a){var g={},h=!0;if((void 0===a?"undefined":c(a))==="object"&&!a.length){for(var b in a)if(a.hasOwnProperty(b)){var i=e(d[b],a[b],f,d,b);void 0!==i&&(h=!1),g[b]=i}return h?void 0:g}return e(d,a,f)}},a.required=function(a,b){function c(a){return void 0===a||""===a||null===a}return function(e){if(a&&c(e))return b||"This field is required.";if(!a&&c(e))throw new d}},a.isNumber=function(a){return function(b){if("number"!=typeof b||isNaN(b))return a||"'{value}' is not a valid number."}},a.isString=function(a){return function(b){if("string"!=typeof b)return a||"'{value}' is not a valid string."}},a.isFunction=function(a){return function(b){if("function"!=typeof b)return a||"Expected a function."}},a.isObject=function(a){return function(b){if(b!==Object(b))return a||"Expected an object."}},a.isArray=function(a){return function(b){if("[object Array]"!==Object.prototype.toString.call(b))return a||"Expected an array."}},a.length=function(a,b){return function(c){if((c+"").length!==a)return b||"It must be "+a+" characters long."}},a.isEmail=function(a){return function(b){if(!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(b))return a||"Invalid email id."}},a.equalsTo=function(a,b){return function(c,d){if(c!==d[a])return b||"'{key}' and '"+a+"' do not match."}},a.minLength=function(a,b){return function(c){if((c+"").length<a)return b||"It must be at least "+a+" characters long."}},a.maxLength=function(a,b){return function(c){if((c+"").length>a)return b||"It must be at most "+a+" characters long."}},a.isBoolean=function(a){return function(b){if(!0!==b&& !1!==b)return a||"Invalid boolean value."}},a.within=function(a,b){return function(c){c instanceof Array||(c=[c]);for(var e=[],d=0;d<c.length;d++)-1===a.indexOf(c[d])&&e.push(c[d]);if(e.length>0)return b||"["+e+"] do not fall under the allowed list."}},a.excludes=function(a,b){return function(c){c instanceof Array||(c=[c]);for(var e=[],d=0;d<c.length;d++)-1!==a.indexOf(c[d])&&e.push(c[d]);if(e.length>0)return b||"["+e+"] fall under restricted values."}},a.pattern=function(a,b){return function(c){if(!a.test(c))return b||"'{value}' does not match with the pattern."}}});(c=a)&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")&&c.default,a.SkipValidation,a.validateSingle;var i=a.validate,b=a.required;a.isNumber,a.isString;var d=a.isFunction,f=a.isObject,g=a.isArray;a.length,a.isEmail,a.equalsTo,a.minLength,a.maxLength,a.isBoolean,a.within,a.excludes,a.pattern;var j=function(){function a(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),k={EBANKING:"EBANKING",MOBILE_BANKING:"MOBILE_BANKING",CONNECT_IPS:"CONNECT_IPS",SCT:"SCT",KHALTI:"KHALTI"},e="https://khalti.s3.ap-south-1.amazonaws.com/KPG/dist/2020.12.17.0.0.0",l=e+"/payment_gateway_widget.html",m=e+"/icons/infinity-loader.svg",n=function(a){return a?JSON.parse(JSON.stringify(a)):a},o={onSuccess:[b(!0),d()],onError:[b(!1),d()],onClose:[b(!1),d()]},p={publicKey:b(!0),productUrl:b(!0),productIdentity:b(!0),productName:b(!0),eventHandler:b(!0),amount:b(!0),merchantData:[b(!1),f()],paymentPreference:[b(!1),g()]};return function(){function a(b){!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,a),this._widgetId="khalti-widget-"+Date.now(),this._config=b,this._widget=this.attachWidget(),this.listenToWidget(),this.paymentType=k,this.widgetLoaded=!1}return j(a,[{key:"listenToWidget",value:function(){var a=this;window.addEventListener("message",function(b){if(b.data.realm){if("widgetInit"===b.data.realm)a.widgetInit(b.data.payload);else if("widgetLoad"!==b.data.realm||a.widgetLoaded){if(!b.data.payload||b.data.payload.widget_id!==a._widgetId)return;a["handle_msg_"+b.data.realm](b.data.payload)}else b.data.payload.loaded&&(a.hideLoader(),a.widgetInit(),a.widgetLoaded=b.data.payload.loaded)}},!1)}},{key:"msgWidget",value:function(b,a){(a=n(a)).widgetId=this._widgetId,a.source="checkout_v2.1",this._widget.contentWindow.postMessage({realm:b,payload:a},"*")}},{key:"handle_msg_widgetInit",value:function(){this.widgetInit()}},{key:"widgetInit",value:function(b){var a=n(this._config);delete a.eventHandler,this.msgWidget("paymentInfo",a)}},{key:"diplayLoader",value:function(){window.document.getElementById("loader"+this._widgetId).style.display="block"}},{key:"hideLoader",value:function(){window.document.getElementById("loader"+this._widgetId).style.display="none"}},{key:"validateConfig",value:function(){var a=i(this._config,p);if(a)throw new Error(JSON.stringify(a));var b=i(this._config.eventHandler,o);if(b)throw new Error(JSON.stringify({eventHandler:b}))}},{key:"handle_msg_walletPaymentVerification",value:function(a){this._config.eventHandler.onSuccess(a),this.hide()}},{key:"handle_msg_widgetError",value:function(b){var a=this._config.eventHandler.onError;a&&a(b)}},{key:"disableParentScrollbar",value:function(){this.parentOverflowValue=window.document.body.style.overflowY,window.document.body.style.overflowY="hidden"}},{key:"enableParentScrollbar",value:function(){window.document.body.style.overflowY=this.parentOverflowValue,this.parentOverflowValue=null}},{key:"show",value:function(a){Object.assign(this._config,a),this.validateConfig(),this.disableParentScrollbar(),this._widget.style.display="block",this.widgetLoaded?this.widgetInit():this.diplayLoader()}},{key:"handle_msg_hide",value:function(){this.hide();var a=this._config.eventHandler.onClose;a&&a()}},{key:"hide",value:function(){this.enableParentScrollbar(),this._widget.style.display="none"}},{key:"attachWidget",value:function(){var a=window.document.createElement("iframe");a.setAttribute("id",this._widgetId),a.style.position="fixed",a.style.display="none",a.style.top="0",a.style.left="0",a.width="100%",a.height=window.innerHeight+"px",a.setAttribute("src",l),a.style.zIndex=99999,a.setAttribute("frameborder",0),a.setAttribute("allowtransparency",!0);var b=window.document.createElement("div");return b.setAttribute("id","loader"+this._widgetId),b.style.width="100%",b.style.height="100%",b.style.backgroundColor="rgba(0, 0, 0, 0.5)",b.style.top="0px",b.style.left="0px",b.style.position="absolute",b.style.display="none",b.innerHTML='<img style="position:relative;left:50%;top:50%;transform:translate(-50%, -50%);z-index: 99999;" src='+m+"></img>",window.document.body.contains(b)||window.document.body.appendChild(b),window.document.body.appendChild(a),a}}]),a}()}()